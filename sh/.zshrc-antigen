source "$HOME/.antigen/antigen.zsh"

# Install antigen
# curl -L https://raw.githubusercontent.com/zsh-users/antigen/master/antigen.zsh > ~/antigen.zsh

antigen use oh-my-zsh

# bundles from oh-my-zsh
antigen bundle git
antigen bundle pip
antigen bundle python
antigen bundle virtualenvwrapper
antigen bundle virtualenv
antigen bundle dirhistory
# antigen bundle vi-mode
# antigen bundle node
# antigen bundle npm
# antigen bundle rake
# antigen bundle rvm
# antigen bundle bundler
antigen bundle history-substring-search
antigen bundle zsh-users/zsh-completions
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle tarruda/zsh-autosuggestions
antigen bundle kennethreitz/autoenv
# antigen bundle command-not-found
antigen bundle history
# antigen bundle tmux
# antigen bundle vundle
# antigen bundle sprunge
# antigen bundle fabric

antigen-theme agnoster

setopt correct_all # Enable autocorrect suggestions
ENABLE_CORRECTION="true"
DISABLE_UNTRACKED_FILES_DIRTY="true"

# Autosuggestion color
AUTOSUGGESTION_HIGHLIGHT_COLOR=fg159
AUTOSUGGESTION_HIGHLIGHT_CURSOR=1
# AUTOSUGGESTION_HIGHLIGHT_COLOR="fg=159,bg=020"
bindkey '^f' vi-forward-blank-word
bindkey '^b' vi-backward-blank-word
# Setup zsh-autosuggestions
zle-line-init() {
    zle autosuggest-start
}
zle -N zle-line-init

export PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$PATH"
# export MANPATH="/usr/local/man:$MANpATH"

export LANG=en_US.UTF-8

# Aliases
alias ll='ls -AlhF'
alias la='ls -aF'
# ls --option not available on OS X. Need to use Homebrew to install coreutils
alias ls='ls --color=tty -F --group-directories-first'
alias l=ls
alias lc='ls --color=tty -F --format=single-column --group-directories-first'
alias rm='trash'
alias cp='cp -i'
alias mv='mv -i'
alias grep='grep --color=auto -nH'

# NOTE: PATH variable *MUST* be set before sourcing virtualenvwrapper.sh
# See http://virtualenvwrapper.readthedocs.org/en/latest/install.html

# For virtualenv support
# Deactivate current virtual env so that flags below will be set properly
# virtualenv_path="$VIRTUAL_ENV"
# echo "Current VIRTUAL_ENV is: $VIRTUAL_ENV"
# if [ $virtualenv_path ]; then
#     echo "Deactivating virtualenv `basename $virtualenv_path`"
#     echo $PATH
#     deactivate
# else
#     echo "No virtualenv to deactivate"
# fi

export VIRTUALENVWRAPPER_PYTHON=`which python`
export VIRTUALENVWRAPPER_VIRTUALENV=`which virtualenv`
export WORKON_HOME=~/virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
export PIP_VIRTUALENV_BASE=~/virtualenvs

# Activate virtualenv
# NOTE: Careful with this as virtualenv may not be available on all machines.
workon ml
# if [ $virtualenv_path ]; then
#     echo "Reapplying virtualenv: $virtualenv_path"
#     # echo "Activating virtualenv `basename` $virtualenv_path"
#     echo $virtualenv_path
#     echo "Activating virtualenv: "
#     echo "`basename $virtualenv_path`"
#     workon "`basename $virtualenv_path`"
# else
#     echo "No active virtualenv"
#     workon ml
# fi

# Configure 256 colors if possible
case $TERM in
    xterm|screen|rxvt-unicode)
        TERM="${TERM}-256color" ;;
esac

# This adds [dd-mm-yy time] that updates to right prompt
RPROMPT='[%D %D{%L:%M:%S %p}]'
# TMOUT=1
# TRAPALRM() {
#     zle reset-prompt
# }

export EDITOR=`which vim`

# bind UP and DOWN arrow keys
zmodload zsh/terminfo
bindkey "$terminfo[kcuu1]" history-substring-search-up
bindkey "$terminfo[kcud1]" history-substring-search-down

autoload -U colors && colors
export SPROMPT="Correct $fg_bold[red]%R$reset_color to $fg_bold[green]%r?$reset_color (Yes, No, Abort, Edit) "

antigen-apply
